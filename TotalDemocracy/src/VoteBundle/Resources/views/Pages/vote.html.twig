{% extends "::base.html.twig" %}

{% block content %}

    <h1>VOTE</h1>

    {% if can_vote %}
        <p>Can vote in:
            <ul>
                {% for electorate in user.electorates %}
                    <li>{{ electorate.domain.name }}</li>
                {% endfor %}
            </ul>
        </p>
    {% else %}
        <p class="color-red">{{ cannot_vote_message | raw }}</p>
    {% endif %}

    <form class="form-inline">
        <div class="form-group">
            <label>Show: </label>

            {% for type, level in domains_levels %}
                <select class="form-control domain-select" data-level="{{ type }}">
                    {% for id, domain in level.domains %}
                        <option
                                {% if id == "" %}
                                    disabled
                                {% else %}
                                    {% if id != level.default %}
                                        value="{{ id }}"
                                    {% else %}
                                        value=""
                                    {% endif %}
                                    {% if id == level.selected %}selected{% endif %}
                                {% endif %}>{{ domain.name }}</option>
                    {% endfor %}
                </select>
            {% endfor %}

        </div>
    </form>

    {% for doc in doc_list %}
        <div>
            <h3>{{ doc.doc.name }}</h3>
            <h6>{{ doc.doc.domain.name }}{% if doc.doc.externalURL is not null %} - <a href="{{ doc.doc.externalURL }}">View details</a>{% endif %}</h6>
            <p>{{ doc.doc.text }}</p>
            {% if can_vote %}
                {#{% if doc.vote is null %}#}
                    <button class="btn btn-success vote-on" data-id="{{ doc.doc.id }}" data-vote="true" {% if doc.yes_vote %}disabled{% endif %}>Yes</button>
                    <button class="btn btn-danger vote-on" data-id="{{ doc.doc.id }}" data-vote="false" {% if doc.no_vote %}disabled{% endif %}>No</button>
                {#{% else %}#}
                    {#<p>{{ doc.vote.isSupporter ? "Yes" : "No" }}</p>#}
                {#{% endif %}#}
            {% endif %}
        </div>
    {% endfor %}

{% endblock %}

{% block javascripts %}

    {% javascripts '@vote' %}
        <script src="{{ asset_url }}"></script>
    {% endjavascripts %}

{% endblock %}
